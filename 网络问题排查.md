# Docker 网络问题排查

## 问题现象
- 镜像源配置成功但无效
- 仍然尝试直连 Docker Hub
- 所有请求超时

## 可能原因
1. 网络连接问题
2. 防火墙阻止
3. DNS 解析问题
4. Docker 缓存问题

## 解决方案

### 1. 检查网络

```bash
ping -c 3 8.8.8.8
nslookup registry-1.docker.io
curl -I https://registry-1.docker.io
```

### 2. 清理 Docker 缓存

```bash
systemctl stop docker
rm -rf /var/lib/docker/tmp/*
systemctl start docker
```

### 3. 重新配置镜像源

```bash
# 删除配置
rm /etc/docker/daemon.json

# 重新创建
echo '{"registry-mirrors":["https://hub-mirror.c.163.com","https://mirror.ccs.tencentyun.com"]}' > /etc/docker/daemon.json

# 重启
systemctl daemon-reload
systemctl restart docker
```

### 4. 直接构建（不预先拉取镜像）

```bash
cd /opt/vocal
docker compose up -d --build
```

虽然慢一些，但可能最终能成功。

### 5. 检查系统资源

```bash
free -h
df -h
```

确保有足够的磁盘空间。

## 备选方案

联系服务器提供商检查：
1. 网络连接是否正常
2. 是否有防火墙限制
3. 是否需要 VPN 或代理
