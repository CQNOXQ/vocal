# StudyTracker 上线检查清单

在将应用部署到生产环境之前，请完成以下检查。

## 🔒 安全配置

- [ ] **更改默认数据库密码**
  - 使用强密码（至少16字符，包含大小写字母、数字、特殊字符）
  - 更新 `.env` 文件中的 `DB_PASS` 和 `MYSQL_ROOT_PASSWORD`

- [ ] **设置强 JWT 密钥**
  - 至少32个随机字符
  - 更新 `.env` 文件中的 `JWT_SECRET`
  - 可以使用以下命令生成：
    ```bash
    openssl rand -base64 32
    ```

- [ ] **配置 CORS**
  - 更新 `CORS_ALLOWED_ORIGINS` 为实际的前端域名
  - 不要使用通配符 `*`（除非有特殊需求）

- [ ] **启用 HTTPS**
  - 获取 SSL 证书（Let's Encrypt 免费）
  - 配置 Nginx 或负载均衡器
  - 强制 HTTP 重定向到 HTTPS

- [ ] **数据库安全**
  - 限制 MySQL 只监听 localhost（如果需要远程访问，使用内网IP）
  - 创建专用数据库用户，仅给予必要权限
  - 禁用 root 远程登录

## 🗄️ 数据库

- [ ] **创建数据库**
  - 使用 UTF8MB4 字符集
  - 备份现有数据（如果有）

- [ ] **运行数据库迁移**
  - 确保 Flyway 迁移成功执行
  - 检查所有表已创建
  - 验证索引已创建

- [ ] **设置定期备份**
  - 配置每日自动备份
  - 测试备份恢复流程
  - 保留至少7天备份

## 🚀 应用部署

- [ ] **构建生产版本**
  - 前端：`npm run build`
  - 后端：`./mvnw clean package -DskipTests`

- [ ] **配置环境变量**
  - 所有敏感信息使用环境变量
  - 不要硬编码密码或密钥
  - 生产环境使用不同的配置

- [ ] **测试应用**
  - 用户注册和登录
  - 创建科目和学习记录
  - 生成邀请码
  - 查看统计和历史记录

## 🔧 服务器配置

- [ ] **防火墙设置**
  - 只开放必要端口（80, 443, 22）
  - 限制 SSH 访问（使用密钥认证）

- [ ] **日志配置**
  - 启用应用日志
  - 配置日志轮转
  - 监控错误日志

- [ ] **监控设置**
  - 配置健康检查
  - 设置资源使用监控（CPU、内存、磁盘）
  - 配置告警通知

- [ ] **域名和 DNS**
  - 配置域名解析
  - 确保 A 记录正确
  - 等待 DNS 传播

## ⚡ 性能优化

- [ ] **数据库优化**
  - 验证索引存在
  - 定期清理过期数据
  - 监控慢查询

- [ ] **静态资源**
  - 启用 Gzip 压缩
  - 配置缓存策略
  - 使用 CDN（可选）

- [ ] **应用优化**
  - 调整线程池大小
  - 配置连接池参数
  - 启用响应缓存

## 📊 监控和维护

- [ ] **日志收集**
  - 配置集中式日志（ELK、Graylog 等）
  - 设置日志级别为 INFO 或 WARN
  - 保留日志至少30天

- [ ] **性能监控**
  - 配置 APM（如 New Relic、Datadog）
  - 监控响应时间
  - 跟踪错误率

- [ ] **备份策略**
  - 自动数据库备份
  - 配置文件备份
  - 测试恢复流程

- [ ] **更新计划**
  - 定期更新依赖
  - 修补安全漏洞
  - 制定回滚计划

## 🧪 测试检查

- [ ] **功能测试**
  - 用户注册（邀请码）
  - 登录和登出
  - 科目管理
  - 学习记录
  - 数据统计

- [ ] **安全测试**
  - 测试 JWT 过期
  - 验证 CORS 设置
  - 检查 SQL 注入防护
  - 测试越权访问

- [ ] **负载测试**
  - 模拟用户并发
  - 测试数据库压力
  - 验证响应时间

## 📝 文档

- [ ] **更新文档**
  - 部署文档
  - API 文档
  - 用户手册

- [ ] **记录配置**
  - 保存环境变量配置（加密存储）
  - 记录服务器信息
  - 记录数据库连接信息

## 🔍 最终检查

- [ ] **安全扫描**
  - 运行依赖漏洞扫描
  - 检查敏感信息泄露
  - 验证 SSL 配置

- [ ] **可用性检查**
  - 从不同网络访问
  - 使用不同浏览器测试
  - 检查移动端显示

- [ ] **应急预案**
  - 准备回滚方案
  - 记录紧急联系方式
  - 准备维护公告

## 🎯 上线后

- [ ] **监控应用运行**
  - 持续监控24小时
  - 检查错误日志
  - 验证功能正常

- [ ] **性能检查**
  - 检查响应时间
  - 监控资源使用
  - 优化瓶颈

- [ ] **用户反馈**
  - 收集用户反馈
  - 及时修复问题
  - 记录改进建议

## 紧急联系信息

- **运维负责人**: [填写]
- **开发负责人**: [填写]
- **数据库管理员**: [填写]

---

**部署日期**: _____________

**部署人员**: _____________

**部署版本**: _____________

